# Enable Bzlmod
common --enable_bzlmod

# PyO3 compatibility for Python 3.13
build --action_env=PYO3_USE_ABI3_FORWARD_COMPATIBILITY=1

# Common build configurations
build --show_result=1
build --symlink_prefix=bazel-

# Go specific settings
# build --@rules_go//go/config:race

# TypeScript/JavaScript settings
# build --@aspect_rules_ts//ts:skipLibCheck=honor_tsconfig
# build --@aspect_rules_js//js:node_options=--max_old_space_size=4096

# Performance optimizations
build --jobs=auto
build --local_resources=memory=HOST_RAM*0.75
build --local_resources=cpu=HOST_CPUS*0.75

# Output options
build --color=yes
build --show_progress_rate_limit=0.1
build --curses=yes
build --ui_event_filters=-info,-debug
build --nolegacy_important_outputs

# Testing options
test --test_output=errors
test --test_verbose_timeout_warnings
test --build_tests_only

# Coverage options
coverage --combined_report=lcov
coverage --coverage_report_generator=@bazel_tools//tools/test/CoverageOutputGenerator/java/com/google/devtools/coverageoutputgenerator:Main

# Debug options
build:debug --compilation_mode=dbg
build:debug --strip=never

# Optimized release build
build:release --compilation_mode=opt
build:release --strip=always

# Try to import user-specific .bazelrc if it exists
try-import %workspace%/.bazelrc.user
